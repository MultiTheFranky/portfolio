---
import { ViewTransitions } from "astro:transitions";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import "../styles/tailwind.css";

interface Props {
    title: string;
}

const { title } = Astro.props;
---

<!doctype html>
<html lang="en" class="noise-overlay">
    <head>
        <meta charset="UTF-8" />
        <meta name="description" content="MultiTheFranky portfolio" />
        <meta name="viewport" content="width=device-width" />
        <link
            rel="apple-touch-icon"
            sizes="180x180"
            href="/apple-touch-icon.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="32x32"
            href="/favicon-32x32.png"
        />
        <link
            rel="icon"
            type="image/png"
            sizes="16x16"
            href="/favicon-16x16.png"
        />
        <link rel="manifest" href="/site.webmanifest" />
        <meta name="generator" content={Astro.generator} />
        <title>{title}</title>
        <ViewTransitions />
    </head>
    <body class="h-full overflow-x-hidden">
        <!-- Animated Background -->
        <div class="animated-bg"></div>

        <!-- Floating Particles -->
        <div class="particles-container" aria-hidden="true">
            <div class="particle p1"></div>
            <div class="particle p2"></div>
            <div class="particle p3"></div>
            <div class="particle p4"></div>
            <div class="particle p5"></div>
            <div class="particle p6"></div>
            <div class="particle p7"></div>
            <div class="particle p8"></div>
        </div>

        <!-- Cursor Glow Effect -->
        <div class="cursor-glow" id="cursor-glow"></div>

        <Header />
        <slot />
        <Footer />

        <style>
            /* Animated gradient background */
            .animated-bg {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -2;
                background: linear-gradient(
                    135deg,
                    #f8fafc 0%,
                    #e2e8f0 25%,
                    #f1f5f9 50%,
                    #e2e8f0 75%,
                    #f8fafc 100%
                );
                background-size: 400% 400%;
                animation: gradient-shift 15s ease infinite;
            }

            :global(.dark) .animated-bg {
                background: linear-gradient(
                    135deg,
                    #0d0950 0%,
                    #1a1a4e 25%,
                    #0f172a 50%,
                    #1e1b4b 75%,
                    #0d0950 100%
                );
                background-size: 400% 400%;
            }

            @keyframes gradient-shift {
                0% {
                    background-position: 0% 50%;
                }
                50% {
                    background-position: 100% 50%;
                }
                100% {
                    background-position: 0% 50%;
                }
            }

            /* Floating particles */
            .particles-container {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: -1;
                overflow: hidden;
            }

            .particle {
                position: absolute;
                border-radius: 50%;
                opacity: 0.6;
            }

            .p1 {
                width: 6px;
                height: 6px;
                background: rgba(0, 177, 187, 0.5);
                top: 20%;
                left: 10%;
                animation: float-particle 8s ease-in-out infinite;
            }

            .p2 {
                width: 8px;
                height: 8px;
                background: rgba(13, 9, 80, 0.4);
                top: 60%;
                left: 20%;
                animation: float-particle 10s ease-in-out infinite 1s;
            }

            .p3 {
                width: 4px;
                height: 4px;
                background: rgba(0, 177, 187, 0.6);
                top: 40%;
                left: 80%;
                animation: float-particle 7s ease-in-out infinite 2s;
            }

            .p4 {
                width: 10px;
                height: 10px;
                background: rgba(13, 9, 80, 0.3);
                top: 80%;
                left: 70%;
                animation: float-particle 12s ease-in-out infinite 0.5s;
            }

            .p5 {
                width: 5px;
                height: 5px;
                background: rgba(0, 177, 187, 0.4);
                top: 10%;
                left: 50%;
                animation: float-particle 9s ease-in-out infinite 3s;
            }

            .p6 {
                width: 7px;
                height: 7px;
                background: rgba(13, 9, 80, 0.5);
                top: 70%;
                left: 40%;
                animation: float-particle 11s ease-in-out infinite 1.5s;
            }

            .p7 {
                width: 3px;
                height: 3px;
                background: rgba(0, 177, 187, 0.7);
                top: 30%;
                left: 90%;
                animation: float-particle 6s ease-in-out infinite 2.5s;
            }

            .p8 {
                width: 9px;
                height: 9px;
                background: rgba(13, 9, 80, 0.35);
                top: 50%;
                left: 5%;
                animation: float-particle 13s ease-in-out infinite 4s;
            }

            @keyframes float-particle {
                0%,
                100% {
                    transform: translate(0, 0) rotate(0deg);
                    opacity: 0.4;
                }
                25% {
                    transform: translate(20px, -30px) rotate(90deg);
                    opacity: 0.7;
                }
                50% {
                    transform: translate(-10px, -60px) rotate(180deg);
                    opacity: 0.5;
                }
                75% {
                    transform: translate(30px, -30px) rotate(270deg);
                    opacity: 0.8;
                }
            }

            /* Cursor glow effect */
            .cursor-glow {
                position: fixed;
                width: 400px;
                height: 400px;
                background: radial-gradient(
                    circle,
                    rgba(0, 177, 187, 0.08) 0%,
                    transparent 70%
                );
                border-radius: 50%;
                pointer-events: none;
                transform: translate(-50%, -50%);
                z-index: -1;
                opacity: 0;
                transition: opacity 0.3s ease;
            }

            :global(.dark) .cursor-glow {
                background: radial-gradient(
                    circle,
                    rgba(0, 177, 187, 0.15) 0%,
                    transparent 70%
                );
            }

            /* Page transition animations */
            :global([data-astro-transition-scope]) {
                animation: page-fade-in 0.5s ease-out;
            }

            @keyframes page-fade-in {
                from {
                    opacity: 0;
                    transform: translateY(20px);
                }
                to {
                    opacity: 1;
                    transform: translateY(0);
                }
            }
        </style>

        <script>
            const setDarkMode = () => {
                const theme: string = (() => {
                    if (
                        typeof localStorage !== "undefined" &&
                        localStorage.getItem("theme")
                    ) {
                        return localStorage.getItem("theme") as string;
                    }
                    if (
                        window.matchMedia("(prefers-color-scheme: dark)")
                            .matches
                    ) {
                        return "dark";
                    }
                    return "light";
                })();

                if (theme === "light") {
                    document.documentElement.classList.remove("dark");
                } else {
                    document.documentElement.classList.add("dark");
                }
                window.localStorage.setItem("theme", theme);
            };

            // Cursor glow effect
            const initCursorGlow = () => {
                const cursorGlow = document.getElementById("cursor-glow");
                if (!cursorGlow) return;

                let mouseX = 0,
                    mouseY = 0;
                let currentX = 0,
                    currentY = 0;

                document.addEventListener("mousemove", (e) => {
                    mouseX = e.clientX;
                    mouseY = e.clientY;
                    cursorGlow.style.opacity = "1";
                });

                document.addEventListener("mouseleave", () => {
                    cursorGlow.style.opacity = "0";
                });

                const animate = () => {
                    currentX += (mouseX - currentX) * 0.1;
                    currentY += (mouseY - currentY) * 0.1;
                    cursorGlow.style.left = currentX + "px";
                    cursorGlow.style.top = currentY + "px";
                    requestAnimationFrame(animate);
                };
                animate();
            };

            // Scroll reveal animation
            const initScrollReveal = () => {
                const prefersReduced = window.matchMedia(
                    "(prefers-reduced-motion: reduce)"
                ).matches;

                const revealElements = document.querySelectorAll(
                    ".scroll-reveal, .scroll-reveal-left, .scroll-reveal-right, .scroll-reveal-scale"
                );

                if (prefersReduced) {
                    revealElements.forEach((el) => el.classList.add("visible"));
                    return;
                }

                const observer = new IntersectionObserver(
                    (entries) => {
                        entries.forEach((entry) => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add("visible");
                                observer.unobserve(entry.target);
                            }
                        });
                    },
                    { threshold: 0.1, rootMargin: "0px 0px -50px 0px" }
                );

                revealElements.forEach((el) => observer.observe(el));
            };

            // Runs on initial navigation
            setDarkMode();
            initCursorGlow();
            initScrollReveal();

            // Runs on view transitions navigation
            document.addEventListener("astro:after-swap", () => {
                setDarkMode();
                initCursorGlow();
                initScrollReveal();
            });
        </script>
    </body>
</html>
