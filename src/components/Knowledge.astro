---
import { Image } from "astro:assets";

type Knowledge = {
    name: string;
    icon: string;
    link: string;
    inverted?: boolean;
};
type MainKnowledge = {
    name: string;
    knowledge: Knowledge[];
};
const frontendKnowledge: Knowledge[] = [
    {
        name: "React",
        icon: "https://cdn.svgporn.com/logos/react.svg",
        link: "https://reactjs.org/"
    },
    {
        name: "Astro",
        icon: "https://cdn.svgporn.com/logos/astro-icon.svg",
        link: "https://astro.build/"
    },
    {
        name: "NextJS",
        icon: "https://cdn.svgporn.com/logos/nextjs-icon.svg",
        link: "https://nextjs.org/"
    },
    {
        name: "TailwindCSS",
        icon: "https://cdn.svgporn.com/logos/tailwindcss-icon.svg",
        link: "https://tailwindcss.com/"
    },
    {
        name: "Sass",
        icon: "https://cdn.svgporn.com/logos/sass.svg",
        link: "https://sass-lang.com/"
    },
    {
        name: "TypeScript",
        icon: "https://cdn.svgporn.com/logos/typescript-icon.svg",
        link: "https://www.typescriptlang.org/"
    },
    {
        name: "JavaScript",
        icon: "https://cdn.svgporn.com/logos/javascript.svg",
        link: "https://www.javascript.com/"
    },
    {
        name: "HTML",
        icon: "https://cdn.svgporn.com/logos/html-5.svg",
        link: "https://developer.mozilla.org/en-US/docs/Web/HTML"
    },
    {
        name: "CSS",
        icon: "https://cdn.svgporn.com/logos/css-3.svg",
        link: "https://developer.mozilla.org/en-US/docs/Web/CSS"
    }
];

const mainFrontendKnowledge = {
    name: "Frontend",
    knowledge: frontendKnowledge
};

const backendKnowledge: Knowledge[] = [
    {
        name: "NodeJS",
        icon: "https://cdn.svgporn.com/logos/nodejs-icon.svg",
        link: "https://nodejs.org/en/"
    },
    {
        name: "Express",
        icon: "https://cdn.worldvectorlogo.com/logos/expressjs.svg",
        link: "https://expressjs.com/",
        inverted: true
    },
    {
        name: "MongoDB",
        icon: "https://cdn.svgporn.com/logos/mongodb-icon.svg",
        link: "https://www.mongodb.com/"
    },
    {
        name: "MySQL",
        icon: "https://cdn.svgporn.com/logos/mysql.svg",
        link: "https://www.mysql.com/"
    },
    {
        name: "PostgreSQL",
        icon: "https://cdn.svgporn.com/logos/postgresql.svg",
        link: "https://www.postgresql.org/"
    },
    {
        name: "Redis",
        icon: "https://cdn.svgporn.com/logos/redis.svg",
        link: "https://redis.io/"
    },
    {
        name: "GraphQL",
        icon: "https://cdn.svgporn.com/logos/graphql.svg",
        link: "https://graphql.org/"
    }
];

const mainBackendKnowledge = {
    name: "Backend",
    knowledge: backendKnowledge
};

const devopsKnowledge: Knowledge[] = [
    {
        name: "Docker",
        icon: "https://cdn.svgporn.com/logos/docker-icon.svg",
        link: "https://www.docker.com/"
    },
    {
        name: "Kubernetes",
        icon: "https://cdn.svgporn.com/logos/kubernetes.svg",
        link: "https://kubernetes.io/"
    },
    {
        name: "Nginx",
        icon: "https://cdn.svgporn.com/logos/nginx.svg",
        link: "https://www.nginx.com/"
    },
    {
        name: "Cloudflare",
        icon: "https://cdn.svgporn.com/logos/cloudflare.svg",
        link: "https://www.cloudflare.com/"
    },
    {
        name: "Azure",
        icon: "https://cdn.svgporn.com/logos/microsoft-azure.svg",
        link: "https://azure.microsoft.com/"
    },
    {
        name: "Google Cloud",
        icon: "https://cdn.svgporn.com/logos/google-cloud.svg",
        link: "https://cloud.google.com/"
    },
    {
        name: "CommerceTools",
        icon: "https://images.ctfassets.net/8q83c033chii/5Gjg45bFu7RmGWLq0wCOll/06e81074e4a44eb6116e0b09cf697834/Partner_Commercetools.svg",
        link: "https://commercetools.com/"
    },
    {
        name: "Twilio",
        icon: "https://cdn.svgporn.com/logos/twilio-icon.svg",
        link: "https://www.twilio.com/"
    },
    {
        name: "SendGrid",
        icon: "https://cdn.svgporn.com/logos/sendgrid-icon.svg",
        link: "https://sendgrid.com/"
    },
    {
        name: "GitHub",
        icon: "https://cdn.svgporn.com/logos/github-octocat.svg",
        link: "https://github.com"
    },
    {
        name: "Grafana",
        icon: "https://cdn.svgporn.com/logos/grafana.svg",
        link: "https://grafana.com/"
    }
];

const mainDevopsKnowledge = {
    name: "DevOps",
    knowledge: devopsKnowledge
};
---

<div>
    <h1
        class="text-center text-2xl font-semibold leading-8 mb-8 mt-32 scroll-reveal"
    >
        Knowledge
    </h1>
    {
        [mainFrontendKnowledge, mainBackendKnowledge, mainDevopsKnowledge].map(
            (mainKnowledge: MainKnowledge, sectionIndex: number) => (
                <div
                    class={`mx-auto max-w-7xl px-6 lg:px-8 scroll-reveal`}
                    style={`transition-delay: ${sectionIndex * 150}ms`}
                >
                    <h2 class="text-center text-lg font-semibold leading-8 mt-8 gradient-text-subtle">
                        {mainKnowledge.name}
                    </h2>
                    <div class="mx-auto mt-10 grid max-w-lg grid-cols-4 items-center gap-x-8 gap-y-10 sm:max-w-xl sm:grid-cols-6 sm:gap-x-10 lg:mx-0 lg:max-w-none lg:grid-cols-5">
                        {mainKnowledge.knowledge.map(
                            (item, itemIndex: number) => (
                                <a
                                    href={item.link}
                                    target="_blank"
                                    rel="noopener noreferrer"
                                    class="skill-card-wrapper flex flex-col items-center group"
                                    style={`animation-delay: ${sectionIndex * 200 + itemIndex * 50}ms`}
                                >
                                    <div class="skill-icon-container relative">
                                        <div class="skill-icon-glow" />
                                        <Image
                                            src={item.icon}
                                            alt={item.name}
                                            width={48}
                                            height={48}
                                            class={`skill-icon h-12 w-12 rounded-md object-contain shadow-sm ${item.inverted ? "dark:invert" : ""}`}
                                            loading="lazy"
                                            decoding="async"
                                        />
                                    </div>
                                    <span class="mt-2 text-sm font-medium skill-name">
                                        {item.name}
                                    </span>
                                </a>
                            )
                        )}
                    </div>
                </div>
            )
        )
    }

    <style>
        .gradient-text-subtle {
            background: linear-gradient(135deg, #64748b, #00b1bb, #64748b);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: shimmer-text 4s linear infinite;
        }

        :global(.dark) .gradient-text-subtle {
            background: linear-gradient(135deg, #94a3b8, #00b1bb, #94a3b8);
            background-size: 200% auto;
            -webkit-background-clip: text;
            background-clip: text;
        }

        @keyframes shimmer-text {
            0% {
                background-position: -100% 0;
            }
            100% {
                background-position: 100% 0;
            }
        }

        .skill-card-wrapper {
            position: relative;
            padding: 1rem;
            border-radius: 1rem;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            transform: translateY(20px);
            animation: skill-fade-in 0.6s ease-out forwards;
        }

        @keyframes skill-fade-in {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .skill-card-wrapper::before {
            content: "";
            position: absolute;
            inset: 0;
            border-radius: 1rem;
            background: linear-gradient(
                135deg,
                rgba(0, 177, 187, 0.1),
                transparent
            );
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .skill-card-wrapper:hover::before {
            opacity: 1;
        }

        .skill-card-wrapper:hover {
            transform: translateY(-12px) scale(1.05);
        }

        .skill-icon-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .skill-icon-glow {
            position: absolute;
            width: 60px;
            height: 60px;
            background: radial-gradient(
                circle,
                rgba(0, 177, 187, 0.4) 0%,
                transparent 70%
            );
            border-radius: 50%;
            opacity: 0;
            transform: scale(0.8);
            transition: all 0.4s ease;
        }

        .skill-card-wrapper:hover .skill-icon-glow {
            opacity: 1;
            transform: scale(1.2);
        }

        .skill-icon {
            position: relative;
            z-index: 1;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .skill-card-wrapper:hover .skill-icon {
            transform: scale(1.15) rotate(5deg);
            filter: drop-shadow(0 8px 20px rgba(0, 177, 187, 0.4));
        }

        .skill-name {
            transition: all 0.3s ease;
            position: relative;
        }

        .skill-card-wrapper:hover .skill-name {
            color: #00b1bb;
            transform: translateY(2px);
        }

        .skill-name::after {
            content: "";
            position: absolute;
            bottom: -2px;
            left: 50%;
            width: 0;
            height: 2px;
            background: linear-gradient(90deg, #00b1bb, #0d0950);
            transition: all 0.3s ease;
            transform: translateX(-50%);
        }

        .skill-card-wrapper:hover .skill-name::after {
            width: 100%;
        }

        /* Staggered reveal animation */
        .scroll-reveal {
            opacity: 0;
            transform: translateY(40px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .scroll-reveal.visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Floating animation on idle */
        @keyframes subtle-float {
            0%,
            100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-5px);
            }
        }

        .skill-card-wrapper:not(:hover) .skill-icon {
            animation: subtle-float 3s ease-in-out infinite;
            animation-delay: var(--float-delay, 0s);
        }
    </style>

    <script>
        // Intersection Observer for scroll reveal
        if (typeof window !== "undefined") {
            const prefersReduced = window.matchMedia(
                "(prefers-reduced-motion: reduce)"
            ).matches;

            if (!prefersReduced) {
                const observer = new IntersectionObserver(
                    (entries) => {
                        entries.forEach((entry) => {
                            if (entry.isIntersecting) {
                                entry.target.classList.add("visible");
                                observer.unobserve(entry.target);
                            }
                        });
                    },
                    { threshold: 0.1, rootMargin: "0px 0px -50px 0px" }
                );

                document
                    .querySelectorAll(".scroll-reveal")
                    .forEach((el) => observer.observe(el));

                // Add random float delays to skill cards
                document
                    .querySelectorAll(".skill-card-wrapper")
                    .forEach((el, i) => {
                        (el as HTMLElement).style.setProperty(
                            "--float-delay",
                            `${i * 0.2}s`
                        );
                    });
            } else {
                document
                    .querySelectorAll(".scroll-reveal")
                    .forEach((el) => el.classList.add("visible"));
            }
        }
    </script>
</div>
